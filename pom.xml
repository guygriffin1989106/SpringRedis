<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>org.springframework.data</groupId>
  <artifactId>spring-data-keyvalue-dist</artifactId>
  <name>Spring Data Key-Value Distribution</name>
  <version>1.0.0.BUILD-SNAPSHOT</version>
  <packaging>pom</packaging>

  <modules>
    <module>spring-data-keyvalue-parent</module>
    <module>spring-data-keyvalue-core</module>
    <module>spring-data-redis</module>
    <module>spring-data-riak</module>
  </modules>

  <build>
    <extensions>
      <extension>
        <groupId>org.springframework.build.aws</groupId>
        <artifactId>org.springframework.build.aws.maven</artifactId>
        <version>2.0.0.RELEASE</version>
      </extension>
    </extensions>

    <plugins>
      <plugin>
        <artifactId>maven-compiler-plugin</artifactId>
        <configuration>
          <source>1.6</source>
          <target>1.6</target>
        </configuration>
      </plugin>

      <plugin>
        <groupId>com.agilejava.docbkx</groupId>
        <artifactId>docbkx-maven-plugin</artifactId>
        <version>2.0.7</version>
        <executions>
          <execution>
            <goals>
              <goal>generate-html</goal>
              <goal>generate-pdf</goal>
            </goals>
            <phase>pre-site</phase>
          </execution>
        </executions>
        <dependencies>
          <dependency>
            <groupId>org.docbook</groupId>
            <artifactId>docbook-xml</artifactId>
            <version>4.4</version>
            <scope>runtime</scope>
          </dependency>
        </dependencies>
        <configuration>
          <includes>index.xml</includes>
          <xincludeSupported>true</xincludeSupported>
          <foCustomization>${project.basedir}/src/docbkx/resources/xsl/fopdf.xsl</foCustomization>
          <htmlStylesheet>css/html.css</htmlStylesheet>
          <chunkedOutput>false</chunkedOutput>
          <htmlCustomization>${project.basedir}/src/docbkx/resources/xsl/html.xsl</htmlCustomization>
          <useExtensions>1</useExtensions>
          <highlightSource>1</highlightSource>
          <highlightDefaultLanguage></highlightDefaultLanguage>
          <!-- callouts -->
          <entities>
            <entity>
              <name>version</name>
              <value>${pom.version}</value>
            </entity>
          </entities>
          <postProcess>
            <copy todir="${project.basedir}/target/site/reference">
              <fileset dir="${project.basedir}/target/docbkx">
                <include name="**/*.html"/>
                <include name="**/*.pdf"/>
              </fileset>
            </copy>
            <copy todir="${project.basedir}/target/site/reference/html">
              <fileset dir="${project.basedir}/src/docbkx/resources">
                <include name="**/*.css"/>
                <include name="**/*.png"/>
                <include name="**/*.gif"/>
                <include name="**/*.jpg"/>
              </fileset>
            </copy>
            <move file="${project.basedir}/target/site/reference/pdf/index.pdf"
                  tofile="${project.basedir}/target/site/reference/pdf/spring-data-keyvalue-reference.pdf"
                  failonerror="false"/>
          </postProcess>
        </configuration>
      </plugin>
      <!--

        <plugin>
          run `mvn package assembly:assembly` to trigger assembly creation.
          see http://www.sonatype.com/books/mvnref-book/reference/assemblies-set-dist-assemblies.html
          <artifactId>maven-assembly-plugin</artifactId>
          <version>2.2-beta-5</version>
          <inherited>false</inherited>
          <executions>
            <execution>
              <id>distribution</id>
              <goals>
                <goal>single</goal>
              </goals>
              <phase>package</phase>
              <configuration>
                <descriptors>
                  <descriptor>${project.basedir}/src/assembly/distribution.xml</descriptor>
                </descriptors>
                <appendAssemblyId>false</appendAssemblyId>
              </configuration>
            </execution>
          </executions>
        </plugin>
        <plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-antrun-plugin</artifactId>
          <version>1.4</version>
          <executions>
            <execution>
              <id>upload-dist</id>
              <phase>deploy</phase>
              <configuration>
                <tasks>
                  <ant antfile="${basedir}/src/ant/upload-dist.xml">
                    <target name="upload-dist"/>
                  </ant>
                </tasks>
              </configuration>
              <goals>
                <goal>run</goal>
              </goals>
            </execution>
          </executions>
          <dependencies>
            <dependency>
              <groupId>org.springframework.build</groupId>
              <artifactId>org.springframework.build.aws.ant</artifactId>
              <version>3.0.5.RELEASE</version>
            </dependency>
            <dependency>
              <groupId>net.java.dev.jets3t</groupId>
              <artifactId>jets3t</artifactId>
              <version>0.7.2</version>
            </dependency>
          </dependencies>
        </plugin>
      </plugins>

      <finalName>${dist.finalName}</finalName>
      -->

    </plugins>
  </build>

  <distributionManagement>
    <!-- see 'staging' profile for dry-run deployment settings -->
    <downloadUrl>http://www.springsource.com/spring-data</downloadUrl>
    <site>
      <id>static.springframework.org</id>
      <url>
        scp://static.springframework.org/var/www/domains/springframework.org/static/htdocs/spring-data/datastore-keyvalue/snapshot-site/
      </url>
    </site>
    <repository>
      <id>spring-milestone</id>
      <name>Spring Milestone Repository</name>
      <url>s3://maven.springframework.org/milestone</url>
    </repository>
    <snapshotRepository>
      <id>spring-snapshot</id>
      <name>Spring Snapshot Repository</name>
      <url>s3://maven.springframework.org/snapshot</url>
    </snapshotRepository>
  </distributionManagement>

</project>